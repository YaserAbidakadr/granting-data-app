<!DOCTYPE html>
<!--[if lt IE 9]><html class="no-js lt-ie9" lang="en" dir="ltr"><![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en" dir="ltr" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<!--<![endif]-->

<head th:replace="~{fragments/general.html :: common_header(~{::title},~{})}">
<meta charset="utf-8">
<title th:text="#{h.viewSFo}"></title>
</head>
<body class="home" vocab="http://schema.org/" typeof="WebPage">
	<div th:insert="~{fragments/general.html :: header_nav('home')}"></div>
	<main role="main" property="mainContentOfPage" class="container">

		<h1 th:text="#{h.viewSFo}"></h1>

		<div th:insert="~{fragments/general.html :: profile_info('home')}"></div>

		<div class="panel panel-default">

			<div class="panel-body">

				<p th:if="${unlinkedPerformedMsg != null}" th:utext="${unlinkedPerformedMsg}" style="font-weight: bold;"></p>

				<div class="form-group row">
					<label class="col-sm-2 col-form-label" th:text="#{form.name}"></label>
					<div class="col-sm-10" th:text="${systemFO.getLocalizedAttribute('name')}"></div>
				</div>

				<div class="form-group row">
					<label class="col-sm-2 col-form-label" th:text="#{msg.extId}"></label>
					<div class="col-sm-10" th:text="${systemFO.extId}"></div>
				</div>

				<div class="form-group row">
					<label class="col-sm-2 col-form-label" th:text="#{msg.goldenFo}"></label>
					<div class="col-sm-10"
						th:text="${systemFO.linkedFundingOpportunity != null} ? ${systemFO.linkedFundingOpportunity.getLocalizedAttribute('name')} : #{msg.noLink}"></div>
				</div>

				<div th:if="${systemFO.linkedFundingOpportunity == null}">

					<div class="form-group">
						<h3 style="margin: 25px 0px;" th:text="#{msg.fosForMapping}"></h3>
					</div>

					<table id="dataTable" class="wb-tables table table-striped table-hover dataTable" aria-live="polite">
						<thead>
							<tr>
								<th th:text="#{msg.foName}"></th>
								<th th:text="#{msg.action}"></th>
							</tr>
						</thead>
						<tbody>
							<tr th:each="foForLink : ${fosForLink}">
								<td><a th:href="@{'/browse/viewFo'(id=${foForLink.id})}" th:text="${foForLink.getLocalizedAttribute('name')}"></a></td>
								<td><form method="post" th:action="registerFOLink">
										<input type="hidden" name="id" th:value="${systemFO.id}" /><input type="hidden" name="foId" th:value="${foForLink.id}" /><input
											class="btn btn-primary" type="submit" th:value="#{input.link}" />
									</form></td>
							</tr>
						</tbody>
					</table>

				</div>

				<!-- 
			<div class="form-group row">
				<div class="col-sm-4 col-form-label" th:utext="#{form.createFromDataset}">Create Entity From Data-set</div>
				<div class="col-sm-8"><form th:action="createfoFromDataset" method="post"><input name="id" type="hidden" th:value="${systemFO.id}"/><input class="btn" type="submit" th:value="#{action.create}"/></form></div>
			</div>
-->

				<div th:if="${systemFO.linkedFundingOpportunity == null}" sec:authorize="hasRole('ROLE_MDM ADMIN')" class="form-group">
					<a th:href="@{'/admin/createFo'(sfoId=${systemFO.id})}" th:text="#{link.createFoFromFc}" class="btn btn-link"></a>
				</div>

				<div th:unless="${systemFO.linkedFundingOpportunity == null}" sec:authorize="hasRole('ROLE_MDM ADMIN')" class="form-group">
					<div>
						<a class="btn btn-primary" id="unlinkSfoBtn" th:href="@{confirmUnlink(sfoId=${systemFO.id})}" role="button" th:text="#{msg.unlinkFo}"></a>
					</div>
				</div>

			</div>

			<div th:insert="fragments/general :: returnHome"></div>

		</div>

	</main>

	<footer th:insert="fragments/general :: footer(~{})"></footer>

</body>
</html>